{% extends "two_factor/_base_focus.html" %}
{% load i18n %}
{% load two_factor_tags %}
{% load widget_tweaks %}

{% block content %}
<!-- Optional test banner -->
<!-- <div style="background: yellow; padding: 6px; text-align:center;">CUSTOM TEMPLATE OVERRIDE IS ACTIVE</div> -->

<!-- âœ… Include Bootstrap directly here -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  body {
    background-color: #f5f7fb;
    font-family: 'Inter', sans-serif;
  }
  .login-card {
    max-width: 420px;
    margin: 60px auto;
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    padding: 40px 35px;
  }
  .login-card h1 {
    font-size: 1.75rem;
    font-weight: 600;
    text-align: center;
    margin-bottom: 0.5rem;
  }
  .login-card p {
    text-align: center;
    color: #6c757d;
  }
  .form-control {
    border-radius: 10px;
  }
  .btn-primary, .btn-secondary {
    border-radius: 10px;
  }
</style>

<div class="login-card">
  <h1>{% trans "Login" %}</h1>

  {% if wizard.steps.current == 'auth' %}
    <p>{% blocktrans %}Enter your credentials.{% endblocktrans %}</p>
  {% elif wizard.steps.current == 'token' %}
    <p>{{ device|as_verbose_action }}</p>
  {% elif wizard.steps.current == 'backup' %}
    <p>{% blocktrans trimmed %}
      Use this form for entering backup tokens for logging in.
      These tokens have been generated for you to print and keep safe.
      Please enter one of these backup tokens to login to your account.
    {% endblocktrans %}</p>
  {% endif %}

  <form action="" method="post" novalidate>
    {% csrf_token %}
    {% include "two_factor/_wizard_forms.html" %}
    <input type="submit" value="" hidden />

    {% if other_devices %}
      <hr>
      <p class="text-center text-muted small">{% trans "Or use one of your other authentication methods:" %}</p>
      <div class="d-grid gap-2">
        {% for other in other_devices %}
          <button name="challenge_device" value="{{ other.persistent_id }}"
                  class="btn btn-outline-secondary" type="submit">
            {{ other|as_action }}
          </button>
        {% endfor %}
      </div>
    {% endif %}

    {% include "two_factor/_wizard_actions.html" %}
  </form>

  {% if backup_tokens %}
    <hr>
    <div class="backup_tokens_form text-center">
      <form action="" method="post">
        {% csrf_token %}
        <p class="text-muted small">{% trans "As a last resort, you can use a backup token:" %}</p>
        <button name="wizard_goto_step" type="submit" value="backup"
                class="btn btn-sm btn-secondary w-100">{% trans "Use Backup Token" %}</button>
      </form>
    </div>
  {% endif %}
</div>
{% endblock %}
